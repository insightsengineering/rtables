<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rtables">
<title>Introduction to rtables • rtables</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to rtables">
<meta property="og:description" content="rtables">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rtables</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.2.9006</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/release-candidate">release-candidate</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.1-rc1">v0.6.1-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.2">v0.6.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.1">v0.6.1</a> </div></li>
<!-- end dropdown for versions -->
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/rtables">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to rtables</h1>
                        <h4 data-toc-skip class="author">Gabriel Becker
and Adrian Waddell</h4>
            
            <h4 data-toc-skip class="date">2023-08-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/rtables/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.reveal .r code {
    white-space: pre;
}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>rtables</code> R package provides a framework to create,
tabulate and output tables in <code>R</code>. Most of the design
requirements for <code>rtables</code> have their origin in studying
tables that are commonly used to report analyses from clinical trials;
however, we were careful to keep <code>rtables</code> a general purpose
toolkit. There are a number of other table frameworks available in
<code>R</code> such as <a href="https://gt.rstudio.com/" class="external-link">gt</a> from
<code>RStudio</code>, <a href="https://CRAN.R-project.org/package=xtable" class="external-link">xtable</a>, <a href="https://CRAN.R-project.org/package=tableone" class="external-link">tableone</a>, and <a href="https://CRAN.R-project.org/package=tables" class="external-link">tables</a> to name a
few. There is a number of reasons to implement <code>rtables</code> (yet
another tables R package):</p>
<ul>
<li>output tables in ASCII to text files</li>
<li>table rendering (ASCII, HTML, etc.) is separate from the data model.
Hence, one always has access to the non-rounded/non-formatted
numbers.</li>
<li>pagination in both horizontal and vertical directions to meet the
health authority submission requirements</li>
<li>cell, row, column, table reference system</li>
<li>titles, footers, and referential footnotes</li>
<li>path based access to cell content which will be useful for automated
content generation</li>
</ul>
<p>In the remainder of this vignette, we give a short introduction into
<code>rtables</code> and tabulating a table. The content is based on the
<a href="https://www.youtube.com/watch?v=CBQzZ8ZhXLA" class="external-link">useR 2020
presentation from Gabriel Becker</a>.</p>
<p>The packages used for this vignette are <code>rtables</code> and
<code>dplyr</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/insightsengineering/rtables" class="external-link">rtables</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The data used in this vignette is a made up using random number
generators. The data content is relatively simple: one row per imaginary
person and one column per measurement: study arm, the country of origin,
gender, handedness, age, and weight.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  arm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Arm A"</span>, <span class="st">"Arm B"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Arm A"</span>, <span class="st">"Arm B"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CAN"</span>, <span class="st">"USA"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.55</span>, <span class="fl">.45</span><span class="op">)</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CAN"</span>, <span class="st">"USA"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  handed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Left"</span>, <span class="st">"Right"</span><span class="op">)</span>, <span class="va">n</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">.4</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Left"</span>, <span class="st">"Right"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>  weight <span class="op">=</span> <span class="fl">35</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"Female"</span>, <span class="fl">140</span>, <span class="fl">180</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/head_tail.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#   arm   country gender handed   age weight</span></span>
<span><span class="co">#   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;">1</span> Arm A USA     Female Left    31.3   139.</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">2</span> Arm B CAN     Female Right   50.5   116.</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">3</span> Arm A USA     Male   Right   32.4   186.</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">4</span> Arm A USA     Male   Right   34.6   169.</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">5</span> Arm B USA     Female Right   43.0   160.</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">6</span> Arm A USA     Female Right   43.2   126.</span></span></code></pre>
<p>Note that we use factor variables so that the level order is
represented in the row or column order when we tabulate the information
of <code>df</code> below.</p>
</div>
<div class="section level2">
<h2 id="building-a-table">Building a Table<a class="anchor" aria-label="anchor" href="#building-a-table"></a>
</h2>
<p>The aim of this vignette is to build the following table step by
step:</p>
<pre><code><span><span class="co">#                     Arm A                     Arm B         </span></span>
<span><span class="co">#              Female        Male        Female        Male   </span></span>
<span><span class="co">#              (N=96)      (N=105)       (N=92)      (N=107)  </span></span>
<span><span class="co"># ————————————————————————————————————————————————————————————</span></span>
<span><span class="co"># CAN        45 (46.9%)   64 (61.0%)   46 (50.0%)   62 (57.9%)</span></span>
<span><span class="co">#   Left     32 (33.3%)   42 (40.0%)   26 (28.3%)   37 (34.6%)</span></span>
<span><span class="co">#     mean      38.9         40.4         40.3         37.7   </span></span>
<span><span class="co">#   Right    13 (13.5%)   22 (21.0%)   20 (21.7%)   25 (23.4%)</span></span>
<span><span class="co">#     mean      36.6         40.2         40.2         40.6   </span></span>
<span><span class="co"># USA        51 (53.1%)   41 (39.0%)   46 (50.0%)   45 (42.1%)</span></span>
<span><span class="co">#   Left     34 (35.4%)   19 (18.1%)   25 (27.2%)   25 (23.4%)</span></span>
<span><span class="co">#     mean      40.4         39.7         39.2         40.1   </span></span>
<span><span class="co">#   Right    17 (17.7%)   22 (21.0%)   21 (22.8%)   20 (18.7%)</span></span>
<span><span class="co">#     mean      36.9         39.8         38.5         39.0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="starting-simple">Starting Simple<a class="anchor" aria-label="anchor" href="#starting-simple"></a>
</h2>
<p>In <code>rtables</code> a basic table is defined to have 0 rows and
one column representing all data. Analyzing a variable is one way of
adding a row:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="va">mean</span>, format <span class="op">=</span> <span class="st">"xx.x"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#        all obs</span></span>
<span><span class="co"># ——————————————</span></span>
<span><span class="co"># mean    39.4</span></span></code></pre>
<div class="section level3">
<h3 id="layout-instructions">Layout Instructions<a class="anchor" aria-label="anchor" href="#layout-instructions"></a>
</h3>
<p>In the code above we first described the table and assigned that
description to a variable <code>lyt</code>. We then built the table
using the actual data with <code><a href="../reference/build_table.html">build_table()</a></code>. The description
of a table is called a table layout. <code><a href="../reference/basic_table.html">basic_table()</a></code> is the
start of every table layout and contains the information that we have in
one column representing all data. The <code><a href="../reference/analyze.html">analyze()</a></code> instruction
adds to the layout that the <code>age</code> variable should be analyzed
with the <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code> analysis function and the result should be
rounded to <code>1</code> decimal place.</p>
<p>Hence, a layout is “pre-data”, that is, it’s a description of how to
build a table once we get data. We can look at the layout isolated:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span></span></code></pre></div>
<pre><code><span><span class="co"># A Pre-data Table Layout</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Column-Split Structure:</span></span>
<span><span class="co">#  () </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Row-Split Structure:</span></span>
<span><span class="co"># age (** analysis **)</span></span></code></pre>
<p>The general layouting instructions are summarized below:</p>
<ul>
<li>
<code><a href="../reference/basic_table.html">basic_table()</a></code> is a layout representing a table with
zero rows and one column</li>
<li>Nested splitting
<ul>
<li>in row space: <code><a href="../reference/split_rows_by.html">split_rows_by()</a></code>,
<code><a href="../reference/split_rows_by_multivar.html">split_rows_by_multivar()</a></code>,
<code><a href="../reference/varcuts.html">split_rows_by_cuts()</a></code>, <code><a href="../reference/varcuts.html">split_rows_by_cutfun()</a></code>,
<code><a href="../reference/varcuts.html">split_rows_by_quartiles()</a></code>
</li>
<li>in column space: <code><a href="../reference/split_cols_by.html">split_cols_by()</a></code>,
<code><a href="../reference/split_cols_by_multivar.html">split_cols_by_multivar()</a></code>,
<code><a href="../reference/varcuts.html">split_cols_by_cuts()</a></code>, <code><a href="../reference/varcuts.html">split_cols_by_cutfun()</a></code>,
<code><a href="../reference/varcuts.html">split_cols_by_quartiles()</a></code>
</li>
</ul>
</li>
<li>Summarizing Groups: <code><a href="../reference/summarize_row_groups.html">summarize_row_groups()</a></code>
</li>
<li>Analyzing Variables: <code><a href="../reference/analyze.html">analyze()</a></code>,
<code><a href="../reference/analyze_colvars.html">analyze_colvars()</a></code>
</li>
</ul>
<p>Using those functions, it is possible to create a wide variety of
tables as we will show in this document.</p>
</div>
<div class="section level3">
<h3 id="adding-column-structure">Adding Column Structure<a class="anchor" aria-label="anchor" href="#adding-column-structure"></a>
</h3>
<p>We will now add more structure to the columns by adding a column
split based on the factor variable <code>arm</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"arm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"age"</span>, afun <span class="op">=</span> <span class="va">mean</span>, format <span class="op">=</span> <span class="st">"xx.x"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#        Arm A   Arm B</span></span>
<span><span class="co"># ————————————————————</span></span>
<span><span class="co"># mean   39.5    39.4</span></span></code></pre>
<p>The resulting table has one column per factor level of
<code>arm</code>. So the data represented by the first column is
<code>df[df$arm == "ARM A", ]</code>. Hence, the
<code><a href="../reference/split_cols_by.html">split_cols_by()</a></code> partitions the data among the columns by
default.</p>
<p>Column splitting can be done in a recursive/nested manner by adding
sequential <code><a href="../reference/split_cols_by.html">split_cols_by()</a></code> layout instruction. It’s also
possible to add a non-nested split. Here we splitting each arm further
by the gender:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"arm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"gender"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"age"</span>, afun <span class="op">=</span> <span class="va">mean</span>, format <span class="op">=</span> <span class="st">"xx.x"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#            Arm A           Arm B    </span></span>
<span><span class="co">#        Female   Male   Female   Male</span></span>
<span><span class="co"># ————————————————————————————————————</span></span>
<span><span class="co"># mean    38.8    40.1    39.6    39.2</span></span></code></pre>
<p>The first column represents the data in <code>df</code> where
<code>df$arm == "A" &amp; df$gender == "Female"</code> and the second
column the data in <code>df</code> where
<code>df$arm == "A" &amp; df$gender == "Male"</code>, and so on.</p>
</div>
<div class="section level3">
<h3 id="adding-row-structure">Adding Row Structure<a class="anchor" aria-label="anchor" href="#adding-row-structure"></a>
</h3>
<p>So far, we have created layouts with analysis and column splitting
instructions, i.e. <code><a href="../reference/analyze.html">analyze()</a></code> and
<code><a href="../reference/split_cols_by.html">split_cols_by()</a></code>, respectively. This resulted with a table
with multiple columns and one data row. We will add more row structure
by stratifying the mean analysis by country (i.e. adding a split in the
row space):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"arm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"gender"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_rows_by.html">split_rows_by</a></span><span class="op">(</span><span class="st">"country"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"age"</span>, afun <span class="op">=</span> <span class="va">mean</span>, format <span class="op">=</span> <span class="st">"xx.x"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#              Arm A           Arm B    </span></span>
<span><span class="co">#          Female   Male   Female   Male</span></span>
<span><span class="co"># ——————————————————————————————————————</span></span>
<span><span class="co"># CAN                                   </span></span>
<span><span class="co">#   mean    38.2    40.3    40.3    38.9</span></span>
<span><span class="co"># USA                                   </span></span>
<span><span class="co">#   mean    39.2    39.7    38.9    39.6</span></span></code></pre>
<p>In this table the data used to derive the first data cell (average of
age of female Canadians in Arm A) is where
<code>df$country == "CAN" &amp; df$arm == "Arm A" &amp; df$gender == "Female"</code>.
This cell value can also be calculated manually:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">country</span> <span class="op">==</span> <span class="st">"CAN"</span> <span class="op">&amp;</span> <span class="va">df</span><span class="op">$</span><span class="va">arm</span> <span class="op">==</span> <span class="st">"Arm A"</span> <span class="op">&amp;</span> <span class="va">df</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"Female"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] 38.22447</span></span></code></pre>
<p>Row structure can also be used to group the table into titled groups
of pages during rendering. We do this via ‘page by splits’, which are
declared via <code>page_by = TRUE</code> within a call to
<code>split_rows_by</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"arm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"gender"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_rows_by.html">split_rows_by</a></span><span class="op">(</span><span class="st">"country"</span>, page_by <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_rows_by.html">split_rows_by</a></span><span class="op">(</span><span class="st">"handed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"age"</span>, afun <span class="op">=</span> <span class="va">mean</span>, format <span class="op">=</span> <span class="st">"xx.x"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/formatters/man/export_as_txt.html" class="external-link">export_as_txt</a></span><span class="op">(</span><span class="va">tbl</span>, page_type <span class="op">=</span> <span class="st">"letter"</span>,</span>
<span>                  page_break <span class="op">=</span> <span class="st">"\n\n~~~~~~ Page Break ~~~~~~\n\n"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># </span></span>
<span><span class="co"># country: CAN</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ————————————————————————————————————————</span></span>
<span><span class="co">#                Arm A           Arm B    </span></span>
<span><span class="co">#            Female   Male   Female   Male</span></span>
<span><span class="co"># ————————————————————————————————————————</span></span>
<span><span class="co"># Left                                    </span></span>
<span><span class="co">#   mean      38.9    40.4    40.3    37.7</span></span>
<span><span class="co"># Right                                   </span></span>
<span><span class="co">#   mean      36.6    40.2    40.2    40.6</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ~~~~~~ Page Break ~~~~~~</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># country: USA</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ————————————————————————————————————————</span></span>
<span><span class="co">#                Arm A           Arm B    </span></span>
<span><span class="co">#            Female   Male   Female   Male</span></span>
<span><span class="co"># ————————————————————————————————————————</span></span>
<span><span class="co"># Left                                    </span></span>
<span><span class="co">#   mean      40.4    39.7    39.2    40.1</span></span>
<span><span class="co"># Right                                   </span></span>
<span><span class="co">#   mean      36.9    39.8    38.5    39.0</span></span></code></pre>
<p>We go into more detail on page-by splits and how to control the
page-group specific titles in the Title and footer vignette.</p>
<p>Note that if you print or render a table without pagination, the
page_by splits are currently rendered as normal row splits. This may
change in future releases.</p>
</div>
<div class="section level3">
<h3 id="adding-group-information">Adding Group Information<a class="anchor" aria-label="anchor" href="#adding-group-information"></a>
</h3>
<p>When adding row splits, we get by default label rows for each split
level, for example <code>CAN</code> and <code>USA</code> in the table
above. Besides the column space subsetting, we have now further
subsetted the data for each cell. It is often useful when defining a row
splitting to display information about each row group. In
<code>rtables</code> this is referred to as content information,
i.e. <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code> on row 2 is a descendant of <code>CAN</code>
(visible via the indenting, though the table has an underlying tree
structure that is not of importance for this vignette). In order to add
content information and turn the <code>CAN</code> label row into a
content row, the <code><a href="../reference/summarize_row_groups.html">summarize_row_groups()</a></code> function is
required. By default, the count (<code>nrows()</code>) and percentage of
data relative to the column associated data is calculated:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"arm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"gender"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_rows_by.html">split_rows_by</a></span><span class="op">(</span><span class="st">"country"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarize_row_groups.html">summarize_row_groups</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"age"</span>, afun <span class="op">=</span> <span class="va">mean</span>, format <span class="op">=</span> <span class="st">"xx.x"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#                   Arm A                     Arm B         </span></span>
<span><span class="co">#            Female        Male        Female        Male   </span></span>
<span><span class="co"># ——————————————————————————————————————————————————————————</span></span>
<span><span class="co"># CAN      45 (46.9%)   64 (61.0%)   46 (50.0%)   62 (57.9%)</span></span>
<span><span class="co">#   mean      38.2         40.3         40.3         38.9   </span></span>
<span><span class="co"># USA      51 (53.1%)   41 (39.0%)   46 (50.0%)   45 (42.1%)</span></span>
<span><span class="co">#   mean      39.2         39.7         38.9         39.6</span></span></code></pre>
<p>The relative percentage for average age of female Canadians is
calculated as follows:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">$</span><span class="va">country</span> <span class="op">==</span> <span class="st">"CAN"</span> <span class="op">&amp;</span> <span class="va">df</span><span class="op">$</span><span class="va">arm</span> <span class="op">==</span> <span class="st">"Arm A"</span> <span class="op">&amp;</span> <span class="va">df</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"Female"</span><span class="op">)</span></span>
<span><span class="va">df_col_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">$</span><span class="va">arm</span> <span class="op">==</span> <span class="st">"Arm A"</span> <span class="op">&amp;</span> <span class="va">df</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"Female"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_cell</span><span class="op">)</span>, percentage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_cell</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_col_1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#      count percentage </span></span>
<span><span class="co">#   45.00000    0.46875</span></span></code></pre>
<p>so the group percentages per row split sum up to 1 for each
column.</p>
<p>We can further split the row space by dividing each country by
handedness:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"arm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"gender"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_rows_by.html">split_rows_by</a></span><span class="op">(</span><span class="st">"country"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarize_row_groups.html">summarize_row_groups</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_rows_by.html">split_rows_by</a></span><span class="op">(</span><span class="st">"handed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"age"</span>, afun <span class="op">=</span> <span class="va">mean</span>, format <span class="op">=</span> <span class="st">"xx.x"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#                     Arm A                     Arm B         </span></span>
<span><span class="co">#              Female        Male        Female        Male   </span></span>
<span><span class="co"># ————————————————————————————————————————————————————————————</span></span>
<span><span class="co"># CAN        45 (46.9%)   64 (61.0%)   46 (50.0%)   62 (57.9%)</span></span>
<span><span class="co">#   Left                                                      </span></span>
<span><span class="co">#     mean      38.9         40.4         40.3         37.7   </span></span>
<span><span class="co">#   Right                                                     </span></span>
<span><span class="co">#     mean      36.6         40.2         40.2         40.6   </span></span>
<span><span class="co"># USA        51 (53.1%)   41 (39.0%)   46 (50.0%)   45 (42.1%)</span></span>
<span><span class="co">#   Left                                                      </span></span>
<span><span class="co">#     mean      40.4         39.7         39.2         40.1   </span></span>
<span><span class="co">#   Right                                                     </span></span>
<span><span class="co">#     mean      36.9         39.8         38.5         39.0</span></span></code></pre>
<p>Next, we further add a count and percentage summary for handedness
within each country:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"arm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"gender"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_rows_by.html">split_rows_by</a></span><span class="op">(</span><span class="st">"country"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarize_row_groups.html">summarize_row_groups</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_rows_by.html">split_rows_by</a></span><span class="op">(</span><span class="st">"handed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarize_row_groups.html">summarize_row_groups</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"age"</span>, afun <span class="op">=</span> <span class="va">mean</span>, format <span class="op">=</span> <span class="st">"xx.x"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#                     Arm A                     Arm B         </span></span>
<span><span class="co">#              Female        Male        Female        Male   </span></span>
<span><span class="co"># ————————————————————————————————————————————————————————————</span></span>
<span><span class="co"># CAN        45 (46.9%)   64 (61.0%)   46 (50.0%)   62 (57.9%)</span></span>
<span><span class="co">#   Left     32 (33.3%)   42 (40.0%)   26 (28.3%)   37 (34.6%)</span></span>
<span><span class="co">#     mean      38.9         40.4         40.3         37.7   </span></span>
<span><span class="co">#   Right    13 (13.5%)   22 (21.0%)   20 (21.7%)   25 (23.4%)</span></span>
<span><span class="co">#     mean      36.6         40.2         40.2         40.6   </span></span>
<span><span class="co"># USA        51 (53.1%)   41 (39.0%)   46 (50.0%)   45 (42.1%)</span></span>
<span><span class="co">#   Left     34 (35.4%)   19 (18.1%)   25 (27.2%)   25 (23.4%)</span></span>
<span><span class="co">#     mean      40.4         39.7         39.2         40.1   </span></span>
<span><span class="co">#   Right    17 (17.7%)   22 (21.0%)   21 (22.8%)   20 (18.7%)</span></span>
<span><span class="co">#     mean      36.9         39.8         38.5         39.0</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="introspecting-rtables-table-objects">Introspecting <code>rtables</code> Table Objects<a class="anchor" aria-label="anchor" href="#introspecting-rtables-table-objects"></a>
</h2>
<p>Once we have created a table, we can inspect its structure using a
number of functions.</p>
<p>The <code><a href="../reference/table_structure.html">table_structure()</a></code> function prints a summary of a
table’s row structure at one of two levels of detail. By default, it
summarizes the structure at the subtable level.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table_structure.html">table_structure</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [TableTree] country</span></span>
<span><span class="co">#  [TableTree] CAN [cont: 1 x 4]</span></span>
<span><span class="co">#   [TableTree] handed</span></span>
<span><span class="co">#    [TableTree] Left [cont: 1 x 4]</span></span>
<span><span class="co">#     [ElementaryTable] age (1 x 4)</span></span>
<span><span class="co">#    [TableTree] Right [cont: 1 x 4]</span></span>
<span><span class="co">#     [ElementaryTable] age (1 x 4)</span></span>
<span><span class="co">#  [TableTree] USA [cont: 1 x 4]</span></span>
<span><span class="co">#   [TableTree] handed</span></span>
<span><span class="co">#    [TableTree] Left [cont: 1 x 4]</span></span>
<span><span class="co">#     [ElementaryTable] age (1 x 4)</span></span>
<span><span class="co">#    [TableTree] Right [cont: 1 x 4]</span></span>
<span><span class="co">#     [ElementaryTable] age (1 x 4)</span></span></code></pre>
<p>When the <code>detail</code> argument is set to <code>"row"</code>,
however, it provides a more detailed row-level summary, which acts as a
useful alternative to how we might normally use the <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code>
function to interrogate compound nested lists.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table_structure.html">table_structure</a></span><span class="op">(</span><span class="va">tbl</span>, detail <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># TableTree: [country] (country)</span></span>
<span><span class="co">#   labelrow: [country] (country) - &lt;not visible&gt;</span></span>
<span><span class="co">#   children: </span></span>
<span><span class="co">#     TableTree: [CAN] (CAN)</span></span>
<span><span class="co">#       labelrow: [CAN] (CAN) - &lt;not visible&gt;</span></span>
<span><span class="co">#       content:</span></span>
<span><span class="co">#         ElementaryTable: [CAN@content] ()</span></span>
<span><span class="co">#           labelrow: [] () - &lt;not visible&gt;</span></span>
<span><span class="co">#           children: </span></span>
<span><span class="co">#             ContentRow: [CAN] (CAN)</span></span>
<span><span class="co">#       children: </span></span>
<span><span class="co">#         TableTree: [handed] (handed)</span></span>
<span><span class="co">#           labelrow: [handed] (handed) - &lt;not visible&gt;</span></span>
<span><span class="co">#           children: </span></span>
<span><span class="co">#             TableTree: [Left] (Left)</span></span>
<span><span class="co">#               labelrow: [Left] (Left) - &lt;not visible&gt;</span></span>
<span><span class="co">#               content:</span></span>
<span><span class="co">#                 ElementaryTable: [Left@content] ()</span></span>
<span><span class="co">#                   labelrow: [] () - &lt;not visible&gt;</span></span>
<span><span class="co">#                   children: </span></span>
<span><span class="co">#                     ContentRow: [Left] (Left)</span></span>
<span><span class="co">#               children: </span></span>
<span><span class="co">#                 ElementaryTable: [age] (age)</span></span>
<span><span class="co">#                   labelrow: [age] (age) - &lt;not visible&gt;</span></span>
<span><span class="co">#                   children: </span></span>
<span><span class="co">#                     DataRow: [mean] (mean)</span></span>
<span><span class="co">#             TableTree: [Right] (Right)</span></span>
<span><span class="co">#               labelrow: [Right] (Right) - &lt;not visible&gt;</span></span>
<span><span class="co">#               content:</span></span>
<span><span class="co">#                 ElementaryTable: [Right@content] ()</span></span>
<span><span class="co">#                   labelrow: [] () - &lt;not visible&gt;</span></span>
<span><span class="co">#                   children: </span></span>
<span><span class="co">#                     ContentRow: [Right] (Right)</span></span>
<span><span class="co">#               children: </span></span>
<span><span class="co">#                 ElementaryTable: [age] (age)</span></span>
<span><span class="co">#                   labelrow: [age] (age) - &lt;not visible&gt;</span></span>
<span><span class="co">#                   children: </span></span>
<span><span class="co">#                     DataRow: [mean] (mean)</span></span>
<span><span class="co">#     TableTree: [USA] (USA)</span></span>
<span><span class="co">#       labelrow: [USA] (USA) - &lt;not visible&gt;</span></span>
<span><span class="co">#       content:</span></span>
<span><span class="co">#         ElementaryTable: [USA@content] ()</span></span>
<span><span class="co">#           labelrow: [] () - &lt;not visible&gt;</span></span>
<span><span class="co">#           children: </span></span>
<span><span class="co">#             ContentRow: [USA] (USA)</span></span>
<span><span class="co">#       children: </span></span>
<span><span class="co">#         TableTree: [handed] (handed)</span></span>
<span><span class="co">#           labelrow: [handed] (handed) - &lt;not visible&gt;</span></span>
<span><span class="co">#           children: </span></span>
<span><span class="co">#             TableTree: [Left] (Left)</span></span>
<span><span class="co">#               labelrow: [Left] (Left) - &lt;not visible&gt;</span></span>
<span><span class="co">#               content:</span></span>
<span><span class="co">#                 ElementaryTable: [Left@content] ()</span></span>
<span><span class="co">#                   labelrow: [] () - &lt;not visible&gt;</span></span>
<span><span class="co">#                   children: </span></span>
<span><span class="co">#                     ContentRow: [Left] (Left)</span></span>
<span><span class="co">#               children: </span></span>
<span><span class="co">#                 ElementaryTable: [age] (age)</span></span>
<span><span class="co">#                   labelrow: [age] (age) - &lt;not visible&gt;</span></span>
<span><span class="co">#                   children: </span></span>
<span><span class="co">#                     DataRow: [mean] (mean)</span></span>
<span><span class="co">#             TableTree: [Right] (Right)</span></span>
<span><span class="co">#               labelrow: [Right] (Right) - &lt;not visible&gt;</span></span>
<span><span class="co">#               content:</span></span>
<span><span class="co">#                 ElementaryTable: [Right@content] ()</span></span>
<span><span class="co">#                   labelrow: [] () - &lt;not visible&gt;</span></span>
<span><span class="co">#                   children: </span></span>
<span><span class="co">#                     ContentRow: [Right] (Right)</span></span>
<span><span class="co">#               children: </span></span>
<span><span class="co">#                 ElementaryTable: [age] (age)</span></span>
<span><span class="co">#                   labelrow: [age] (age) - &lt;not visible&gt;</span></span>
<span><span class="co">#                   children: </span></span>
<span><span class="co">#                     DataRow: [mean] (mean)</span></span></code></pre>
<p>The <code><a href="https://rdrr.io/pkg/formatters/man/make_row_df.html" class="external-link">make_row_df()</a></code> and <code><a href="../reference/make_col_df.html">make_col_df()</a></code>
functions create a data.frame which has a variety of information about
the table’s structure. Most useful for introspection purposes are the
<code>label</code>, <code>name</code>, <code>abs_rownumber</code>,
<code>path</code> and <code>node_class</code> columns (the remainder of
information in the returned data.frame is used for pagination)</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/formatters/man/make_row_df.html" class="external-link">make_row_df</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"label"</span>, <span class="st">"name"</span>, <span class="st">"abs_rownumber"</span>, <span class="st">"path"</span>, <span class="st">"node_class"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#    label  name abs_rownumber         path node_class</span></span>
<span><span class="co"># 1    CAN   CAN             1 country,.... ContentRow</span></span>
<span><span class="co"># 2   Left  Left             2 country,.... ContentRow</span></span>
<span><span class="co"># 3   mean  mean             3 country,....    DataRow</span></span>
<span><span class="co"># 4  Right Right             4 country,.... ContentRow</span></span>
<span><span class="co"># 5   mean  mean             5 country,....    DataRow</span></span>
<span><span class="co"># 6    USA   USA             6 country,.... ContentRow</span></span>
<span><span class="co"># 7   Left  Left             7 country,.... ContentRow</span></span>
<span><span class="co"># 8   mean  mean             8 country,....    DataRow</span></span>
<span><span class="co"># 9  Right Right             9 country,.... ContentRow</span></span>
<span><span class="co"># 10  mean  mean            10 country,....    DataRow</span></span></code></pre>
<p>By default <code><a href="https://rdrr.io/pkg/formatters/man/make_row_df.html" class="external-link">make_row_df()</a></code> summarizes only visible rows,
but setting <code>visible_only</code> to <code>FALSE</code> gives us a
structural summary of the table, including the full hierarchy of
subtables, including those that aren’t represented directly by any
visible rows:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/formatters/man/make_row_df.html" class="external-link">make_row_df</a></span><span class="op">(</span><span class="va">tbl</span>, visible_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"label"</span>, <span class="st">"name"</span>, <span class="st">"abs_rownumber"</span>, <span class="st">"path"</span>, <span class="st">"node_class"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#    label          name abs_rownumber         path      node_class</span></span>
<span><span class="co"># 1              country            NA      country       TableTree</span></span>
<span><span class="co"># 2                  CAN            NA country, CAN       TableTree</span></span>
<span><span class="co"># 3          CAN@content            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 4    CAN           CAN             1 country,....      ContentRow</span></span>
<span><span class="co"># 5               handed            NA country,....       TableTree</span></span>
<span><span class="co"># 6                 Left            NA country,....       TableTree</span></span>
<span><span class="co"># 7         Left@content            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 8   Left          Left             2 country,....      ContentRow</span></span>
<span><span class="co"># 9                  age            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 10  mean          mean             3 country,....         DataRow</span></span>
<span><span class="co"># 11               Right            NA country,....       TableTree</span></span>
<span><span class="co"># 12       Right@content            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 13 Right         Right             4 country,....      ContentRow</span></span>
<span><span class="co"># 14                 age            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 15  mean          mean             5 country,....         DataRow</span></span>
<span><span class="co"># 16                 USA            NA country, USA       TableTree</span></span>
<span><span class="co"># 17         USA@content            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 18   USA           USA             6 country,....      ContentRow</span></span>
<span><span class="co"># 19              handed            NA country,....       TableTree</span></span>
<span><span class="co"># 20                Left            NA country,....       TableTree</span></span>
<span><span class="co"># 21        Left@content            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 22  Left          Left             7 country,....      ContentRow</span></span>
<span><span class="co"># 23                 age            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 24  mean          mean             8 country,....         DataRow</span></span>
<span><span class="co"># 25               Right            NA country,....       TableTree</span></span>
<span><span class="co"># 26       Right@content            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 27 Right         Right             9 country,....      ContentRow</span></span>
<span><span class="co"># 28                 age            NA country,.... ElementaryTable</span></span>
<span><span class="co"># 29  mean          mean            10 country,....         DataRow</span></span></code></pre>
<p><code><a href="../reference/make_col_df.html">make_col_df()</a></code> similarly accepts
<code>visible_only</code>, though here the meaning is slightly
different, indicating whether only <em>leaf</em> columns should be
summarized (<code>TRUE</code>, the default) or whether higher level
groups of columns, analogous to subtables in row space, should be
summarized as well.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_col_df.html">make_col_df</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#     name  label abs_pos         path pos_in_siblings n_siblings leaf_indices</span></span>
<span><span class="co"># 1 Female Female       1 arm, Arm....               1          2            1</span></span>
<span><span class="co"># 2   Male   Male       2 arm, Arm....               2          2            2</span></span>
<span><span class="co"># 3 Female Female       3 arm, Arm....               1          2            3</span></span>
<span><span class="co"># 4   Male   Male       4 arm, Arm....               2          2            4</span></span>
<span><span class="co">#   total_span col_fnotes n_col_fnotes</span></span>
<span><span class="co"># 1          1                       0</span></span>
<span><span class="co"># 2          1                       0</span></span>
<span><span class="co"># 3          1                       0</span></span>
<span><span class="co"># 4          1                       0</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_col_df.html">make_col_df</a></span><span class="op">(</span><span class="va">tbl</span>, visible_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#     name  label abs_pos         path pos_in_siblings n_siblings leaf_indices</span></span>
<span><span class="co"># 1  Arm A  Arm A      NA   arm, Arm A               1          2         1, 2</span></span>
<span><span class="co"># 2 Female Female       1 arm, Arm....               1          2            1</span></span>
<span><span class="co"># 3   Male   Male       2 arm, Arm....               2          2            2</span></span>
<span><span class="co"># 4  Arm B  Arm B      NA   arm, Arm B               2          2         3, 4</span></span>
<span><span class="co"># 5 Female Female       3 arm, Arm....               1          2            3</span></span>
<span><span class="co"># 6   Male   Male       4 arm, Arm....               2          2            4</span></span>
<span><span class="co">#   total_span col_fnotes n_col_fnotes</span></span>
<span><span class="co"># 1          2                       0</span></span>
<span><span class="co"># 2          1                       0</span></span>
<span><span class="co"># 3          1                       0</span></span>
<span><span class="co"># 4          2                       0</span></span>
<span><span class="co"># 5          1                       0</span></span>
<span><span class="co"># 6          1                       0</span></span></code></pre>
<p>The <code><a href="../reference/row_paths_summary.html">row_paths_summary()</a></code> and
<code><a href="../reference/row_paths_summary.html">col_paths_summary()</a></code> functions wrap the respective
<code>make_*_df</code> functions, printing the <code>name</code>,
<code>node_class</code> and <code>path</code> information (in the row
case), or the <code>label</code> and <code>path</code> information (in
the column case), indented to illustrate table structure:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/row_paths_summary.html">row_paths_summary</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># rowname     node_class    path                                        </span></span>
<span><span class="co"># ——————————————————————————————————————————————————————————————————————</span></span>
<span><span class="co"># CAN         ContentRow    country, CAN, @content, CAN                 </span></span>
<span><span class="co">#   Left      ContentRow    country, CAN, handed, Left, @content, Left  </span></span>
<span><span class="co">#     mean    DataRow       country, CAN, handed, Left, age, mean       </span></span>
<span><span class="co">#   Right     ContentRow    country, CAN, handed, Right, @content, Right</span></span>
<span><span class="co">#     mean    DataRow       country, CAN, handed, Right, age, mean      </span></span>
<span><span class="co"># USA         ContentRow    country, USA, @content, USA                 </span></span>
<span><span class="co">#   Left      ContentRow    country, USA, handed, Left, @content, Left  </span></span>
<span><span class="co">#     mean    DataRow       country, USA, handed, Left, age, mean       </span></span>
<span><span class="co">#   Right     ContentRow    country, USA, handed, Right, @content, Right</span></span>
<span><span class="co">#     mean    DataRow       country, USA, handed, Right, age, mean</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/row_paths_summary.html">col_paths_summary</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># label       path                      </span></span>
<span><span class="co"># ——————————————————————————————————————</span></span>
<span><span class="co"># Arm A       arm, Arm A                </span></span>
<span><span class="co">#   Female    arm, Arm A, gender, Female</span></span>
<span><span class="co">#   Male      arm, Arm A, gender, Male  </span></span>
<span><span class="co"># Arm B       arm, Arm B                </span></span>
<span><span class="co">#   Female    arm, Arm B, gender, Female</span></span>
<span><span class="co">#   Male      arm, Arm B, gender, Male</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>In this vignette you have learned:</p>
<ul>
<li>every cell has an associated subset of data
<ul>
<li>this means that much of tabulation has to do with
splitting/subsetting data</li>
</ul>
</li>
<li>tables can be described pre-data using layouts</li>
<li>tables are a form of visualization of data</li>
</ul>
<p>The other vignettes in the <code>rtables</code> package will provide
more detailed information about the <code>rtables</code> package. We
recommend that you continue with the <a href="https://insightsengineering.github.io/rtables/main/articles/tabulation_dplyr.html"><code>tabulation_dplyr</code></a>
vignette which compares the information derived by the table in this
vignette using <code>dplyr</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Gabriel Becker, Adrian Waddell.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
