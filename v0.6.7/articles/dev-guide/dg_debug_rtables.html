<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rtables">
<title>Debugging in {rtables} and Beyond • rtables</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Debugging in {rtables} and Beyond">
<meta property="og:description" content="rtables">
<meta property="og:image" content="https://insightsengineering.github.io/rtables/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="../../consent.css">
<script src="../../consent.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">rtables</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.7</small>

    <div style="width: 140px; margin-left: 0.5rem;"> <small class="nav-text text-muted me-auto">part of</small> <img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/nest.png?raw=true" alt="NEST" style="height: 30px;"><a href="https://pharmaverse.org/" class="external-link"><img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/pharmaverse.png?raw=true" alt="pharmaverse" style="height: 28px;"></a> </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Getting Started</h6>
    <a class="dropdown-item" href="../../articles/introduction.html">Introduction to {rtables}</a>
    <a class="dropdown-item" href="../../articles/exploratory_analysis.html">Exploratory Analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Clinical Trials</h6>
    <a class="dropdown-item" href="../../articles/clinical_trials.html">Example Clinical Trials Tables</a>
    <a class="dropdown-item" href="../../articles/baseline.html">Comparing Against Baselines or Control</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Table Customization</h6>
    <a class="dropdown-item" href="../../articles/custom_appearance.html">Customizing Appearance</a>
    <a class="dropdown-item" href="../../articles/title_footer.html">Titles, Footers, and Referential Footnotes</a>
    <a class="dropdown-item" href="../../articles/sorting_pruning.html">Pruning and Sorting Tables</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/index.html">More articles...</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-developer-guide">Developer Guide</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-developer-guide">
    <a class="dropdown-item" href="../../articles/dev-guide/dg_split_machinery.html">Split Machinery</a>
    <a class="dropdown-item" href="../../articles/dev-guide/dg_tabulation.html">Tabulation</a>
    <a class="dropdown-item" href="../../articles/dev-guide/dg_table_hierarchy.html">Table Hierarchy</a>
    <a class="dropdown-item" href="../../articles/dev-guide/dg_debug_rtables.html">Debugging in {rtables} and Beyond</a>
    <a class="dropdown-item" href="../../articles/dev-guide/dg_notes.html">Sparse Notes on {rtables} Internals</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>

<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reports">Reports</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reports">
    <a class="dropdown-item" href="../../coverage-report/">Coverage report</a>
    <a class="dropdown-item" href="../../unit-test-report/">Unit test report</a>
  </div>
</li>
      <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/release-candidate">release-candidate</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/latest-release">latest-release</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.12-rc2">v0.6.12-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.12-rc1">v0.6.12-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.11">v0.6.11</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.10">v0.6.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.9">v0.6.9</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.8">v0.6.8</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.7">v0.6.7</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.6">v0.6.6</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.6-rc1">v0.6.6-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.5">v0.6.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.4">v0.6.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.3">v0.6.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.2">v0.6.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.1">v0.6.1</a>
</div>
</li>
</ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/rtables">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Debugging in {rtables} and Beyond</h1>
                        <h4 data-toc-skip class="author">Davide
Garolini</h4>

            <h4 data-toc-skip class="date">2024-04-16</h4>

      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/rtables/blob/main/vignettes/dev-guide/dg_debug_rtables.Rmd" class="external-link"><code>vignettes/dev-guide/dg_debug_rtables.Rmd</code></a></small>
      <div class="d-none name"><code>dg_debug_rtables.Rmd</code></div>
    </div>



<div class="section level2">
<h2 id="debugging">Debugging<a class="anchor" aria-label="anchor" href="#debugging"></a>
</h2>
<p>This is a short and non-comprehensive guide to debugging
<code>rtables</code>. Regardless, it is to be considered valid for
personal use at your discretion.</p>
<div class="section level4">
<h4 id="coding-in-practice">Coding in Practice<a class="anchor" aria-label="anchor" href="#coding-in-practice"></a>
</h4>
<ul>
<li>It is easy to read and find problems</li>
<li>It is not clever if it is impossible to debug</li>
</ul>
</div>
<div class="section level4">
<h4 id="some-definitions">Some Definitions<a class="anchor" aria-label="anchor" href="#some-definitions"></a>
</h4>
<ul>
<li>
<strong>Coding Error</strong> - Code does not do what you intended
-&gt; Bug in the punch card</li>
<li>
<strong>Unexpected Input</strong> - Defensive programming FAIL FAST
FAIL LOUD (FFFL) -&gt; useful and not too time consuming</li>
<li>
<strong>Bug in Dependency</strong> -&gt; never use dependencies if
you can!</li>
</ul>
</div>
<div class="section level4">
<h4 id="considerations-about-fffl">Considerations About FFFL<a class="anchor" aria-label="anchor" href="#considerations-about-fffl"></a>
</h4>
<p>Errors should be as close as possible to the source. For example, bad
inputs should be found very early. The worst possible example is a
software that is silently giving incorrect results. Common things that
we can catch early are missing values, column <code>length == 0</code>,
or <code>length &gt; 1</code>.</p>
</div>
<div class="section level4">
<h4 id="general-suggestions">General Suggestions<a class="anchor" aria-label="anchor" href="#general-suggestions"></a>
</h4>
<ul>
<li>Robust code base does not attempt doing possibly problematic
operations.</li>
<li>Read Error Messages</li>
<li>
<code>debugcall</code> you can add the signature (formals)</li>
<li>
<code>trace</code> is powerful because you can add the reaction</li>
<li>
<code>tracer</code> is very good and precise to find where it
happens</li>
</ul>
<p><code>options(error = recover)</code> is one of the best tools to
debug at it is a core tool when developing that allows you to step into
any point of the function call sequence.</p>
<p><code>dump.frames</code> and <code>debugger</code>: it saves it to a
file or an object and then you call debugger to step in it as you did
recover.</p>
</div>
<div class="section level4">
<h4 id="warn-global-option">
<code>warn</code> Global Option<a class="anchor" aria-label="anchor" href="#warn-global-option"></a>
</h4>
<ul>
<li>
<code>&lt;0</code> ignored</li>
<li>
<code>0</code> top level function call</li>
<li>
<code>1</code> immediately as they occur</li>
<li>
<code>&gt;=2</code> throws errors</li>
</ul>
<p><code>&lt;&lt;-</code> for <code>recover</code> or
<code>debugger</code> gives it to the global environment</p>
</div>
<div class="section level4">
<h4 id="direct-modification-techniques">direct-modification techniques<a class="anchor" aria-label="anchor" href="#direct-modification-techniques"></a>
</h4>
<ul>
<li>PRINT / CAT is always a low level debugging that can be used. It is
helpful for server jobs where maybe only terminal or console output is
available and no <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code> can be used. For example, you
can print the position or state of a function at a certain point until
you find the break point.</li>
<li>comment blocks -&gt; does not work with pipes (you can use
<code><a href="https://rdrr.io/r/base/identity.html" class="external-link">identity()</a></code> it is a step that does nothing but does not
break the pipes)</li>
<li>
<code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code> bombing</li>
</ul>
</div>
<div class="section level4">
<h4 id="regression-tests">Regression Tests<a class="anchor" aria-label="anchor" href="#regression-tests"></a>
</h4>
<p>Almost every bug should become a regression test.</p>
</div>
<div class="section level4">
<h4 id="debugging-with-pipes">Debugging with Pipes<a class="anchor" aria-label="anchor" href="#debugging-with-pipes"></a>
</h4>
<ul>
<li>Pipes are better to write code but horrible to debug</li>
<li>T in pipe <code>%T&gt;%</code> does print it midway</li>
<li>
<code><a href="https://magrittr.tidyverse.org/reference/debug_pipe.html" class="external-link">debug_pipe()</a></code> -&gt; it is like the T pipe going into
browser()</li>
</ul>
</div>
<div class="section level4">
<h4 id="shiny-debugging">Shiny Debugging<a class="anchor" aria-label="anchor" href="#shiny-debugging"></a>
</h4>
<p>More difficult due to reactivity.</p>
</div>
<div class="section level4">
<h4 id="general-suggestion">General Suggestion<a class="anchor" aria-label="anchor" href="#general-suggestion"></a>
</h4>
<p>DO NOT BE CLEVER WITH CODE - ONLY IF YOU HAVE TO, CLEVER IS ALSO
SUBJECTIVE AND IT WILL CHANGE WITH TIME.</p>
</div>
</div>
<div class="section level2">
<h2 id="debugging-in-rtables">Debugging in <code>rtables</code><a class="anchor" aria-label="anchor" href="#debugging-in-rtables"></a>
</h2>
<p>We invite the smart developer to use the provided examples as a way
to get an “interactive” and dynamic view of the internal algorithms as
they are routinely executed when constructing tables with
<code>rtables</code>. This is achieved by using <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code>
and <code><a href="https://rdrr.io/r/base/debug.html" class="external-link">debugonce()</a></code> on internal and exported functions
(<code>rtables:::</code> or <code>rtables::</code>), as we will see in a
moment. We invite you to continuously and autonomously explore the
multiple <code>S3</code> and <code>S4</code> objects that constitute the
complexity and power of <code>rtables</code>. To do so, we will use the
following functions:</p>
<ul>
<li>
<code>methods(generic_function)</code>: This function lists the
methods that are available for a generic function. Specifically for
<code>S4</code> generic functions,
<code>showMethods(generic_function)</code> gives more detailed
information about each method (e.g. inheritance).</li>
<li>
<code>class(object)</code>: This function returns the class of an
object. If the class is not one of the built-in classes in R, you can
use this information to search for its documentation and examples.
<code><a href="https://rdrr.io/r/base/class.html" class="external-link">help(class)</a></code> may be informative as it will call the
documentation of the specific class. Similarly, the <code>?</code>
operator will bring up the documentation page for different
<code>S4</code> methods. For <code>S3</code> methods it is necessary to
postfix the class name with a dot (e.g. <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">?summary.lm</a></code>).</li>
<li>
<code>getClass(class)</code>: This describes the type of class in a
compact way, the slots that it has, and the relationships that it may
have with the other classes that may inherit from or be inherited by it.
With <code>getClass(object)</code> we can see to which values the slots
of the object are assigned. It is possible to use
<code>str(object, max.level = 2)</code> to see less formal and more
compact descriptions of the slots, but it may be problematic when there
are one or more objects in the class slots. Hence, the maximum number of
levels should always be limited to 2 or 3 (<code>max.level = 2</code>).
Similarly, <code><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes()</a></code> can be used to retrieve some
information, but we need to remember that storing important variables in
this way is not encouraged. Information regarding the type of class can
be retrieved with <code><a href="https://rdrr.io/r/base/mode.html" class="external-link">mode()</a></code> and indirectly by
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and <code>is.S4()</code>.
*<code>getAnywhere(function)</code> is very useful to get the source
code of internal functions and specific generics. It works very well
with <code>S3</code> methods, and will display the relevant namespace
for each of the methods found. Similarly,
<code>getMethod(S4_generic, S4_class)</code> can retrieve the source
code of class-specific <code>S4</code> methods.</li>
<li>
<code>eval(debugcall(generic_function(obj)))</code>: this is a very
useful way to browse a <code>S4</code> method, specifically for a
defined object, without having to manually insert <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code>
into the code. It is also possible to do similarly with R &gt; 3.4.0
where <code>debug*()</code> calls can have the triggering signature
(class) specified. Both of these are modern and simplified wrappers of
the tracing function <code><a href="https://rdrr.io/r/base/trace.html" class="external-link">trace()</a></code>.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="nest">
  <p>rtables is a part of the <strong>NEST</strong> and <a href="https://pharmaverse.org/" class="external-link"><strong>pharmaverse</strong></a>.</p>
</div>
<script type="text/javascript" src="../../analytics.js"></script></footer>
</div>





  </body>
</html>
