<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Collection of utilities to extract data.frame objects from TableTree objects.">
<title>Generate a result data frame — data.frame_export • rtables</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate a result data frame — data.frame_export">
<meta property="og:description" content="Collection of utilities to extract data.frame objects from TableTree objects.">
<meta property="og:image" content="https://insightsengineering.github.io/rtables/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="../consent.css">
<script src="../consent.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rtables</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.7</small>

    <div style="width: 140px; margin-left: 0.5rem;"> <small class="nav-text text-muted me-auto">part of</small> <img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/nest.png?raw=true" alt="NEST" style="height: 30px;"><a href="https://pharmaverse.org/" class="external-link"><img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/pharmaverse.png?raw=true" alt="pharmaverse" style="height: 28px;"></a> </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Getting Started</h6>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to {rtables}</a>
    <a class="dropdown-item" href="../articles/exploratory_analysis.html">Exploratory Analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Clinical Trials</h6>
    <a class="dropdown-item" href="../articles/clinical_trials.html">Example Clinical Trials Tables</a>
    <a class="dropdown-item" href="../articles/baseline.html">Comparing Against Baselines or Control</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Table Customization</h6>
    <a class="dropdown-item" href="../articles/custom_appearance.html">Customizing Appearance</a>
    <a class="dropdown-item" href="../articles/title_footer.html">Titles, Footers, and Referential Footnotes</a>
    <a class="dropdown-item" href="../articles/sorting_pruning.html">Pruning and Sorting Tables</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-developer-guide">Developer Guide</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-developer-guide">
    <a class="dropdown-item" href="../articles/dev-guide/dg_split_machinery.html">Split Machinery</a>
    <a class="dropdown-item" href="../articles/dev-guide/dg_tabulation.html">Tabulation</a>
    <a class="dropdown-item" href="../articles/dev-guide/dg_table_hierarchy.html">Table Hierarchy</a>
    <a class="dropdown-item" href="../articles/dev-guide/dg_debug_rtables.html">Debugging in {rtables} and Beyond</a>
    <a class="dropdown-item" href="../articles/dev-guide/dg_notes.html">Sparse Notes on {rtables} Internals</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>

<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reports">Reports</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reports">
    <a class="dropdown-item" href="../coverage-report/">Coverage report</a>
    <a class="dropdown-item" href="../unit-test-report/">Unit test report</a>
  </div>
</li>
      <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/release-candidate">release-candidate</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/latest-release">latest-release</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.14">v0.6.14</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.13">v0.6.13</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.13-rc2">v0.6.13-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.13-rc1">v0.6.13-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.12">v0.6.12</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.12-rc2">v0.6.12-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.12-rc1">v0.6.12-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.11">v0.6.11</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.10">v0.6.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.9">v0.6.9</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.8">v0.6.8</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.7">v0.6.7</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.6">v0.6.6</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.6-rc1">v0.6.6-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.5">v0.6.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.4">v0.6.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.3">v0.6.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.2">v0.6.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.1">v0.6.1</a>
</div>
</li>
</ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/rtables">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate a result data frame</h1>
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/rtables/blob/main/R/tt_export.R" class="external-link"><code>R/tt_export.R</code></a></small>
      <div class="d-none name"><code>data.frame_export.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Collection of utilities to extract <code>data.frame</code> objects from <code>TableTree</code> objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">as_result_df</span><span class="op">(</span><span class="va">tt</span>, spec <span class="op">=</span> <span class="st">"v0_experimental"</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">result_df_specs</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">path_enriched_df</span><span class="op">(</span><span class="va">tt</span>, path_fun <span class="op">=</span> <span class="va">collapse_path</span>, value_fun <span class="op">=</span> <span class="va">collapse_values</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h2>
    <dl>
<dt>tt</dt>
<dd><p>(<code>TableTree</code> or related class)<br> a <code>TableTree</code> object representing a populated table.</p></dd>


<dt>spec</dt>
<dd><p>(<code>string</code>)<br> the specification to use to extract the result data frame. See Details below.</p></dd>


<dt>simplify</dt>
<dd><p>(<code>flag</code>)<br> whether the result data frame should only have labels and result columns visible.</p></dd>


<dt>...</dt>
<dd>
<p>additional arguments passed to spec-specific result data frame conversion function. Currently it can be
one or more of the following parameters (valid only for <code>v0_experimental</code> spec. for now):</p>
<ul>
<li><p><code>expand_colnames</code>: when <code>TRUE</code>, the result data frame will have expanded column names above the usual
output. This is useful when the result data frame is used for further processing.</p></li>
<li><p><code>simplify</code>: when <code>TRUE</code>, the result data frame will have only visible labels and result columns.</p></li>
<li><p><code>as_strings</code>: when <code>TRUE</code>, the result data frame will have all values as strings, as they appear
in the final table (it can also be retrieved from <code>matrix_form(tt)$strings</code>). This is also true for
column counts if <code>expand_colnames = TRUE</code>.</p></li>
<li><p><code>as_viewer</code>: when <code>TRUE</code>, the result data frame will have all values as they appear in the final table,
i.e. with the same precision and numbers, but in easy-to-use numeric form.</p></li>
<li><p><code>keep_label_rows</code>: when <code>TRUE</code>, the result data frame will have all labels as they appear in the
final table.</p></li>
<li><p><code>as_is</code>: when <code>TRUE</code>, the result data frame will have all the values as they appear in the final table,
but without information about the row structure. Row labels will be assigned to rows so to work well
with <code><a href="df_to_tt.html">df_to_tt()</a></code>.</p></li>
</ul>
</dd>


<dt>path_fun</dt>
<dd><p>(<code>function</code>)<br> function to transform paths into single-string row/column names.</p></dd>


<dt>value_fun</dt>
<dd><p>(<code>function</code>)<br> function to transform cell values into cells of a <code>data.frame</code>. Defaults to
<code>collapse_values</code>, which creates strings where multi-valued cells are collapsed together, separated by <code>|</code>.</p></dd>

</dl>
</div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h2>


<ul>
<li><p><code>as_result_df</code> returns a result <code>data.frame</code>.</p></li>
</ul>
<ul>
<li><p><code>result_df_specs()</code> returns a named list of result data frame extraction functions by "specification".</p></li>
</ul>
<ul>
<li><p><code>path_enriched_df()</code> returns a <code>data.frame</code> of <code>tt</code>'s cell values (processed by <code>value_fun</code>, with columns named by
the full column paths (processed by <code>path_fun</code> and an additional <code>row_path</code> column with the row paths (processed
by <code>path_fun</code>).</p></li>
</ul>
</div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
    <p><code>as_result_df()</code>: Result data frame specifications may differ in the exact information
they include and the form in which they represent it. Specifications whose names end in "_experimental"
are subject to change without notice, but specifications without the "_experimental"
suffix will remain available <em>including any bugs in their construction</em> indefinitely.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>

<ul>
<li><p><code>result_df_specs()</code>: A list of functions that extract result data frames from <code>TableTree</code>s.</p></li>
<li><p><code>path_enriched_df()</code>: Transform a <code>TableTree</code> object to a path-enriched <code>data.frame</code>.</p></li>
</ul>
</div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
    <div class="dont-index"><p><code><a href="df_to_tt.html">df_to_tt()</a></code> when using <code>as_is = TRUE</code> and <code><a href="https://insightsengineering.github.io/formatters/latest-tag/reference/make_row_df.html" class="external-link">make_row_df()</a></code> to have a comprehensive view of the
hierarchical structure of the rows.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"ARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="split_rows_by.html">split_rows_by</a></span><span class="op">(</span><span class="st">"STRATA1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="analyze.html">analyze</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGE"</span>, <span class="st">"BMRKR2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">ex_adsl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">as_result_df</span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    spl_var_1 spl_value_1 avar_name row_name label_name row_num is_group_summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    STRATA1           A       AGE     Mean       Mean       3            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    STRATA1           A    BMRKR2      LOW        LOW       5            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    STRATA1           A    BMRKR2   MEDIUM     MEDIUM       6            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    STRATA1           A    BMRKR2     HIGH       HIGH       7            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    STRATA1           B       AGE     Mean       Mean      10            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    STRATA1           B    BMRKR2      LOW        LOW      12            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    STRATA1           B    BMRKR2   MEDIUM     MEDIUM      13            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    STRATA1           B    BMRKR2     HIGH       HIGH      14            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    STRATA1           C       AGE     Mean       Mean      17            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   STRATA1           C    BMRKR2      LOW        LOW      19            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   STRATA1           C    BMRKR2   MEDIUM     MEDIUM      20            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   STRATA1           C    BMRKR2     HIGH       HIGH      21            FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    node_class A: Drug X B: Placebo C: Combination</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     DataRow  33.07895   35.11364         34.225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     DataRow        12         16             14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     DataRow        10         17             13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     DataRow        16         11             13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     DataRow  33.85106         36       36.32558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     DataRow        19         13             10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     DataRow        13         22             16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     DataRow        15         10             17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     DataRow  34.22449   35.17778       35.63265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    DataRow        19         16             16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    DataRow        14         17             13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    DataRow        16         12             20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">result_df_specs</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $v0_experimental</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function(tt,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       as_viewer = FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       as_strings = FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       expand_colnames = FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       keep_label_rows = FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       as_is = FALSE) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   checkmate::assert_flag(as_viewer)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   checkmate::assert_flag(as_strings)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   checkmate::assert_flag(expand_colnames)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   checkmate::assert_flag(keep_label_rows)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   checkmate::assert_flag(as_is)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (as_is) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     keep_label_rows &lt;- TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     expand_colnames &lt;- FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   raw_cvals &lt;- cell_values(tt)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ## if the table has one row and multiple columns, sometimes the cell values returns a list of the cell values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ## rather than a list of length 1 representing the single row. This is bad but may not be changeable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ## at this point.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (nrow(tt) == 1 &amp;&amp; length(raw_cvals) &gt; 1) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     raw_cvals &lt;- list(raw_cvals)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # Flatten the list of lists (rows) of cell values into a data frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cellvals &lt;- as.data.frame(do.call(rbind, raw_cvals))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   row.names(cellvals) &lt;- NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (nrow(tt) == 1 &amp;&amp; ncol(tt) == 1) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     colnames(cellvals) &lt;- names(raw_cvals)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (as_viewer || as_strings) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     # we keep previous calculations to check the format of the data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mf_tt &lt;- matrix_form(tt)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mf_result_chars &lt;- mf_strings(mf_tt)[-seq_len(mf_nlheader(mf_tt)), -1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mf_result_chars &lt;- .remove_empty_elements(mf_result_chars)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mf_result_numeric &lt;- as.data.frame(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       .make_numeric_char_mf(mf_result_chars)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mf_result_chars &lt;- as.data.frame(mf_result_chars)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!setequal(dim(mf_result_numeric), dim(cellvals)) || !setequal(dim(mf_result_chars), dim(cellvals))) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       stop(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "The extracted numeric data.frame does not have the same dimension of the",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         " cell values extracted with cell_values(). This is a bug. Please report it."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ) # nocov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (as_strings) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       colnames(mf_result_chars) &lt;- colnames(cellvals)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       cellvals &lt;- mf_result_chars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       colnames(mf_result_numeric) &lt;- colnames(cellvals)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       cellvals &lt;- mf_result_numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rdf &lt;- make_row_df(tt)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   df &lt;- rdf[, c("name", "label", "abs_rownumber", "path", "reprint_inds", "node_class")]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # Removing initial root elements from path (out of the loop -&gt; right maxlen)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   df$path &lt;- lapply(df$path, .remove_root_elems_from_path,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     which_root_name = c("root", "rbind_root"),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all = TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   maxlen &lt;- max(lengths(df$path))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # Loop for metadata (path and details from make_row_df)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   metadf &lt;- do.call(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rbind.data.frame,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lapply(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seq_len(NROW(df)),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       function(ii) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         handle_rdf_row(df[ii, ], maxlen = maxlen)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # Should we keep label rows with NAs instead of values?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (keep_label_rows) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cellvals_mat_struct &lt;- as.data.frame(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       matrix(NA, nrow = nrow(rdf), ncol = ncol(cellvals))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     colnames(cellvals_mat_struct) &lt;- colnames(cellvals)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cellvals_mat_struct[metadf$node_class != "LabelRow", ] &lt;- cellvals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ret &lt;- cbind(metadf, cellvals_mat_struct)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ret &lt;- cbind(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       metadf[metadf$node_class != "LabelRow", ],</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       cellvals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # If we want to expand colnames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (expand_colnames) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     col_name_structure &lt;- .get_formatted_colnames(clayout(tt))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     number_of_non_data_cols &lt;- which(colnames(ret) == "node_class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (NCOL(ret) - number_of_non_data_cols != NCOL(col_name_structure)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       stop(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "When expanding colnames structure, we were not able to find the same",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         " number of columns as in the result data frame. This is a bug. Please report it."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ) # nocov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_rows_for_colnames &lt;- matrix(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       rep("&lt;only_for_column_names&gt;", number_of_non_data_cols * NROW(col_name_structure)),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       nrow = NROW(col_name_structure)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     header_colnames_matrix &lt;- cbind(buffer_rows_for_colnames, data.frame(col_name_structure))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     colnames(header_colnames_matrix) &lt;- colnames(ret)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     count_row &lt;- NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (disp_ccounts(tt)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ccounts &lt;- col_counts(tt)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       if (as_strings) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ccounts &lt;- mf_strings(mf_tt)[mf_nlheader(mf_tt), ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ccounts &lt;- .remove_empty_elements(ccounts)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       count_row &lt;- c(rep("&lt;only_for_column_counts&gt;", number_of_non_data_cols), ccounts)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       header_colnames_matrix &lt;- rbind(header_colnames_matrix, count_row)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ret &lt;- rbind(header_colnames_matrix, ret)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # Using only labels for row names and losing information about paths</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (as_is) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     tmp_rownames &lt;- ret$label_name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ret &lt;- ret[, -seq_len(which(colnames(ret) == "node_class"))]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (length(unique(tmp_rownames)) == length(tmp_rownames)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       rownames(ret) &lt;- tmp_rownames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ret &lt;- cbind("label_name" = tmp_rownames, ret)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       rownames(ret) &lt;- NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rownames(ret) &lt;- NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ret</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: namespace:rtables&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"ARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="analyze.html">analyze</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGE"</span>, <span class="st">"BMRKR2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">ex_adsl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">path_enriched_df</span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      row_path ARM|A: Drug X ARM|B: Placebo ARM|C: Combination</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      ma_AGE_BMRKR2|AGE|Mean      33.76866       35.43284           35.43182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    ma_AGE_BMRKR2|BMRKR2|LOW      50.00000       45.00000           40.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 ma_AGE_BMRKR2|BMRKR2|MEDIUM      37.00000       56.00000           42.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   ma_AGE_BMRKR2|BMRKR2|HIGH      47.00000       33.00000           50.00000</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="nest">
  <p>rtables is a part of the <strong>NEST</strong> and <a href="https://pharmaverse.org/" class="external-link"><strong>pharmaverse</strong></a>.</p>
</div>
<script type="text/javascript" src="../analytics.js"></script></footer>
</div>





  </body>
</html>
