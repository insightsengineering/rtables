<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rtables">
<title>Column Counts and Formats • rtables</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Column Counts and Formats">
<meta property="og:description" content="rtables">
<meta property="og:image" content="https://insightsengineering.github.io/rtables/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="../consent.css">
<script src="../consent.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rtables</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.8</small>

    <div style="width: 140px; margin-left: 0.5rem;"> <small class="nav-text text-muted me-auto">part of</small> <img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/nest.png?raw=true" alt="NEST" style="height: 30px;"><a href="https://pharmaverse.org/" class="external-link"><img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/pharmaverse.png?raw=true" alt="pharmaverse" style="height: 28px;"></a> </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Getting Started</h6>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to {rtables}</a>
    <a class="dropdown-item" href="../articles/exploratory_analysis.html">Exploratory Analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Clinical Trials</h6>
    <a class="dropdown-item" href="../articles/clinical_trials.html">Example Clinical Trials Tables</a>
    <a class="dropdown-item" href="../articles/baseline.html">Comparing Against Baselines or Control</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Table Customization</h6>
    <a class="dropdown-item" href="../articles/custom_appearance.html">Customizing Appearance</a>
    <a class="dropdown-item" href="../articles/title_footer.html">Titles, Footers, and Referential Footnotes</a>
    <a class="dropdown-item" href="../articles/sorting_pruning.html">Pruning and Sorting Tables</a>
    <a class="dropdown-item" href="../articles/col_counts.html">Column Counts and Formats</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-developer-guide">Developer Guide</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-developer-guide">
    <a class="dropdown-item" href="../articles/dev-guide/dg_split_machinery.html">Split Machinery</a>
    <a class="dropdown-item" href="../articles/dev-guide/dg_tabulation.html">Tabulation</a>
    <a class="dropdown-item" href="../articles/dev-guide/dg_table_hierarchy.html">Table Hierarchy</a>
    <a class="dropdown-item" href="../articles/dev-guide/dg_debug_rtables.html">Debugging in {rtables} and Beyond</a>
    <a class="dropdown-item" href="../articles/dev-guide/dg_notes.html">Sparse Notes on {rtables} Internals</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>

<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reports">Reports</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reports">
    <a class="dropdown-item" href="../coverage-report/">Coverage report</a>
    <a class="dropdown-item" href="../unit-test-report/">Unit test report</a>
  </div>
</li>
      <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/release-candidate">release-candidate</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.13-rc2">v0.6.13-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.13-rc1">v0.6.13-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.12">v0.6.12</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.12-rc2">v0.6.12-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.12-rc1">v0.6.12-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.11">v0.6.11</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.10">v0.6.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.9">v0.6.9</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.8">v0.6.8</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.7">v0.6.7</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.6">v0.6.6</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.6-rc1">v0.6.6-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.5">v0.6.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.4">v0.6.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.3">v0.6.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.2">v0.6.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rtables/v0.6.1">v0.6.1</a>
</div>
</li>
</ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/rtables">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Column Counts and Formats</h1>
                        <h4 data-toc-skip class="author">Davide
Garolini</h4>

            <h4 data-toc-skip class="date">2024-06-20</h4>

      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/rtables/blob/main/vignettes/col_counts.Rmd" class="external-link"><code>vignettes/col_counts.Rmd</code></a></small>
      <div class="d-none name"><code>col_counts.Rmd</code></div>
    </div>



<div class="section level2">
<h2 id="the-old-way">The Old Way<a class="anchor" aria-label="anchor" href="#the-old-way"></a>
</h2>
<p>Many tables call for column counts to be displayed in the header
material of a table (i.e., interspersed with the column labels).</p>
<p>Historically, <code>rtables</code> supported this only for so-called
leaf or individual columns.</p>
<div class="section level3">
<h3 id="setting-column-counts-to-visible-at-layout-time">Setting column counts to visible at Layout time<a class="anchor" aria-label="anchor" href="#setting-column-counts-to-visible-at-layout-time"></a>
</h3>
<p>Display of column counts (off by default) was primarily achieved via
passing <code>show_colcounts = TRUE</code> to <code>basic_table</code> ,
e.g.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># </span></span>
<span><span class="co"># Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co"># The following objects are masked from 'package:stats':</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     filter, lag</span></span></code></pre>
<pre><code><span><span class="co"># The following objects are masked from 'package:base':</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/insightsengineering/rtables" class="external-link">rtables</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># Loading required package: formatters</span></span></code></pre>
<pre><code><span><span class="co"># </span></span>
<span><span class="co"># Attaching package: 'formatters'</span></span></code></pre>
<pre><code><span><span class="co"># The following object is masked from 'package:base':</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     %||%</span></span></code></pre>
<pre><code><span><span class="co"># Loading required package: magrittr</span></span></code></pre>
<pre><code><span><span class="co"># </span></span>
<span><span class="co"># Attaching package: 'rtables'</span></span></code></pre>
<pre><code><span><span class="co"># The following object is masked from 'package:utils':</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     str</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span>show_colcounts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"ARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"SEX"</span>, split_fun <span class="op">=</span> <span class="fu"><a href="../reference/split_funcs.html">keep_split_levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"AGE"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, <span class="va">ex_adsl</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#           A: Drug X        B: Placebo       C: Combination  </span></span>
<span><span class="co">#          F        M        F        M         F         M   </span></span>
<span><span class="co">#        (N=79)   (N=51)   (N=77)   (N=55)   (N=66)    (N=60) </span></span>
<span><span class="co"># ————————————————————————————————————————————————————————————</span></span>
<span><span class="co"># Mean   32.76    35.57    34.12    37.44     35.20     35.38</span></span></code></pre>
<p>The format of the counts could also be controlled by the
<code>colcount_format</code> argument to <code>basic_table</code>.</p>
<p>We had no way of displaying (or, in fact, even easily calculating)
the <code>ARM</code> facet counts.</p>
</div>
<div class="section level3">
<h3 id="modifying-counts-on-an-existing-table">Modifying counts on an existing table<a class="anchor" aria-label="anchor" href="#modifying-counts-on-an-existing-table"></a>
</h3>
<p>(Leaf-)column counts could be altered after the fact via the
<code>col_counts&lt;-</code> getter:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/col_accessors.html">col_counts</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#           A: Drug X        B: Placebo       C: Combination  </span></span>
<span><span class="co">#          F        M        F        M         F         M   </span></span>
<span><span class="co">#        (N=17)   (N=18)   (N=19)   (N=17)   (N=18)    (N=19) </span></span>
<span><span class="co"># ————————————————————————————————————————————————————————————</span></span>
<span><span class="co"># Mean   32.76    35.57    34.12    37.44     35.20     35.38</span></span></code></pre>
<p><strong>NB</strong> doing this has never updated percentages that
appear within the table as they are calculated at table-creation time,
so this can lead to misleading results when not used with care.</p>
</div>
<div class="section level3">
<h3 id="hiding-counts">Hiding counts<a class="anchor" aria-label="anchor" href="#hiding-counts"></a>
</h3>
<p>We did not provide a user-visible way to toggle column count display
after table creation, though we did support showing a blank space for
particular counts by setting them to <code>NA</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/col_accessors.html">col_counts</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">18</span>, <span class="cn">NA</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span></code></pre></div>
<pre><code><span><span class="co">#           A: Drug X        B: Placebo      C: Combination  </span></span>
<span><span class="co">#          F        M        F       M         F         M   </span></span>
<span><span class="co">#        (N=17)   (N=18)           (N=17)   (N=18)    (N=19) </span></span>
<span><span class="co"># ———————————————————————————————————————————————————————————</span></span>
<span><span class="co"># Mean   32.76    35.57    34.12   37.44     35.20     35.38</span></span></code></pre>
<p>These mechanisms will all continue to work for the forseeable future,
though new code is advised use the new API discussed below.</p>
</div>
</div>
<div class="section level2">
<h2 id="higher-level-column-counts">Higher Level Column Counts<a class="anchor" aria-label="anchor" href="#higher-level-column-counts"></a>
</h2>
<p>Starting in <code>rtables</code> version <code>6.8.0</code>, the
concept of column counts is modeled and handled with much more
granularity than previously. Each facet in column space now has a column
count (whether or not it is displayed), which will appear directly under
the corresponding column label (spanning the same number of rows) when
set to be visible.</p>
<div class="section level3">
<h3 id="setting-column-counts-to-visible-at-layout-time-1">Setting Column Counts to Visible at Layout Time<a class="anchor" aria-label="anchor" href="#setting-column-counts-to-visible-at-layout-time-1"></a>
</h3>
<p>The primary way for users to create tables which displays these
“high-level” column counts is to create a layout that specifies they
should be visible.</p>
<p>We do this with the new <code>show_colcounts</code> argument now
accepted by all <code>split_cols_by*</code> layout functions.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"ARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"SEX"</span>,</span>
<span>    split_fun <span class="op">=</span> <span class="fu"><a href="../reference/split_funcs.html">keep_split_levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_colcounts <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"AGE"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt2</span>, <span class="va">ex_adsl</span><span class="op">)</span></span>
<span><span class="va">tbl2</span></span></code></pre></div>
<pre><code><span><span class="co">#           A: Drug X        B: Placebo       C: Combination  </span></span>
<span><span class="co">#          F        M        F        M         F         M   </span></span>
<span><span class="co">#        (N=79)   (N=51)   (N=77)   (N=55)   (N=66)    (N=60) </span></span>
<span><span class="co"># ————————————————————————————————————————————————————————————</span></span>
<span><span class="co"># Mean   32.76    35.57    34.12    37.44     35.20     35.38</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_table.html">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"ARM"</span>, show_colcounts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/split_cols_by.html">split_cols_by</a></span><span class="op">(</span><span class="st">"SEX"</span>, split_fun <span class="op">=</span> <span class="fu"><a href="../reference/split_funcs.html">keep_split_levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analyze.html">analyze</a></span><span class="op">(</span><span class="st">"AGE"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">lyt3</span>, <span class="va">ex_adsl</span><span class="op">)</span></span>
<span><span class="va">tbl3</span></span></code></pre></div>
<pre><code><span><span class="co">#          A: Drug X      B: Placebo      C: Combination  </span></span>
<span><span class="co">#           (N=134)         (N=134)           (N=132)     </span></span>
<span><span class="co">#          F       M       F       M        F         M   </span></span>
<span><span class="co"># ————————————————————————————————————————————————————————</span></span>
<span><span class="co"># Mean   32.76   35.57   34.12   37.44    35.20     35.38</span></span></code></pre>
<p>As before, these column counts are calculated at table creation time,
using <code>alt_counts_df</code> if it is provided (or simply
<code>df</code> otherwise).</p>
<p>Column formats are set at layout time via the
<code>colcount_format</code> argument <em>of the specific
<code>split_cols_by</code> call</em>.</p>
</div>
<div class="section level3">
<h3 id="manipulating-column-counts-in-an-existing-table">Manipulating Column Counts In An Existing Table<a class="anchor" aria-label="anchor" href="#manipulating-column-counts-in-an-existing-table"></a>
</h3>
<p>Manipulation of column counts (beyond the old setters provided for
backwards compatibility) is path based. In other words, when we set a
column count (e.g., to NA so it displays as a blank) or set the
visibilty of a set of column counts, we do so by indicating them via
column paths. The ability to alter column count formats on an existing
table is currently not offered by any exported functions.</p>
<p>Column paths can be obtained via <code>col_paths</code> for the leaf
columns, or via <code>make_col_df(tbl, visible_only = FALSE)$path</code>
for all addressable facets.</p>
<div class="section level4">
<h4 id="setting-individual-column-counts">Setting individual column counts<a class="anchor" aria-label="anchor" href="#setting-individual-column-counts"></a>
</h4>
<p>The <code>facet_colcount</code> getter and setter queries and sets
the column count for a facet in column space (note it needs not be a
leaf facet). E.g.,</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/facet_colcount.html">facet_colcount</a></span><span class="op">(</span><span class="va">tbl3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ARM"</span>, <span class="st">"C: Combination"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] 132</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/facet_colcount.html">facet_colcount</a></span><span class="op">(</span><span class="va">tbl3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ARM"</span>, <span class="st">"C: Combination"</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">75</span></span>
<span><span class="va">tbl3</span></span></code></pre></div>
<pre><code><span><span class="co">#          A: Drug X      B: Placebo      C: Combination  </span></span>
<span><span class="co">#           (N=134)         (N=134)           (N=75)      </span></span>
<span><span class="co">#          F       M       F       M        F         M   </span></span>
<span><span class="co"># ————————————————————————————————————————————————————————</span></span>
<span><span class="co"># Mean   32.76   35.57   34.12   37.44    35.20     35.38</span></span></code></pre>
<p>For convenience (primarily because it was needed internally), we also
provide <code>rm_all_colcounts</code> which sets <em>all</em> column
counts for a particular table to <code>NA</code> at all levels of
nesting. We do not expect this to be particularly useful to
end-users.</p>
</div>
<div class="section level4">
<h4 id="setting-col-count-visibility">Setting Col Count Visibility<a class="anchor" aria-label="anchor" href="#setting-col-count-visibility"></a>
</h4>
<p>Typically we do not set column count visibility individually. *This
is due to a constraint where direct leaf siblings (e.g. F and M under
one of the arms in our layout) must have the same visibility for their
column counts in order for the rendering machinery to work.</p>
<p>Instead, we can reset the column count visibility of groups of
siblings via the <code>facet_colcounts_visible</code> (note the ‘s’)
setter. This function accepts a path which ends in the name associated
with a splitting instruction in the layout (e.g., <code>c("ARM")</code>,
<code>c("ARM", "B: Placebo", "SEX")</code>, etc) and <em>resets the
visibility of all direct children of that path</em>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">facet_colcounts_visible</span><span class="op">(</span><span class="va">tbl3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ARM"</span>, <span class="st">"A: Drug X"</span>, <span class="st">"SEX"</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">tbl3</span></span></code></pre></div>
<pre><code><span><span class="co">#           A: Drug X                                       </span></span>
<span><span class="co">#            (N=134)        B: Placebo      C: Combination  </span></span>
<span><span class="co">#          F        M         (N=134)           (N=75)      </span></span>
<span><span class="co">#        (N=79)   (N=51)     F       M        F         M   </span></span>
<span><span class="co"># ——————————————————————————————————————————————————————————</span></span>
<span><span class="co"># Mean   32.76    35.57    34.12   37.44    35.20     35.38</span></span></code></pre>
<p><strong>NOTE</strong> as we can see here, the visibility of column
counts can have an “unbalanced design”, provided the direct-siblings
agreeing constraint is met. This leads to things not lining up directly
as one might expect (it does not generate any blank spaces the way
setting a visible column count to <code>NA</code> does).</p>
<p>Currently paths with <code>"*"</code> in them do not work within
<code>facet_colcounts_visible</code>, but that capability is likely to
be added in future releases.</p>
<p><code>colcount_visible</code> getters and setters do also exist which
retrieve and set individual column counts’ visiblities, but these are
largely an internal detail and in virtually all cases end users should
avoid calling them directly.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## BEWARE</span></span>
<span><span class="va">tbl4</span> <span class="op">&lt;-</span> <span class="va">tbl3</span></span>
<span><span class="fu"><a href="../reference/colcount_visible.html">colcount_visible</a></span><span class="op">(</span><span class="va">tbl4</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ARM"</span>, <span class="st">"A: Drug X"</span>, <span class="st">"SEX"</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">tbl4</span></span></code></pre></div>
<pre><code><span><span class="co"># Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'toString': Detected different colcount visibility among sibling facets (those arising from the same split_cols_by* layout instruction). This is not supported.</span></span>
<span><span class="co"># Set count values to NA if you want a blank space to appear as the displayed count for particular facets.</span></span>
<span><span class="co"># First disagreement occured at paths:</span></span>
<span><span class="co"># ARM[A: Drug X]-&gt;SEX[F]</span></span>
<span><span class="co"># ARM[A: Drug X]-&gt;SEX[M]</span></span></code></pre>
<p>Note currently this restriction is currently only enforced for leaf
columns due to technical implementation details but how a table renders
should be considered undefined behavior when it contains a group of
sibling column facets arising from the same layout instruction whose
column count visiblities disagree. That may become an error in future
versions without warning.</p>
</div>
<div class="section level4">
<h4 id="advanced-settings">Advanced Settings<a class="anchor" aria-label="anchor" href="#advanced-settings"></a>
</h4>
<p>By using <code><a href="../reference/make_col_df.html">make_col_df()</a></code> we can see the full path to any
column count. One example application is to add a <code>NA</code> value
that would print to the default value is <code>""</code>, that will show
nothing. To change (for now uniformly only) the output string in case of
missing values in the column counts you can use
<code>colcount_na_str</code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coldf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_col_df.html">make_col_df</a></span><span class="op">(</span><span class="va">tbl3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/facet_colcount.html">facet_colcount</a></span><span class="op">(</span><span class="va">tbl3</span>, <span class="va">coldf</span><span class="op">$</span><span class="va">path</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA_integer_</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tbl3</span><span class="op">)</span> <span class="co"># Keeps the missing space</span></span></code></pre></div>
<pre><code><span><span class="co">#           A: Drug X                                       </span></span>
<span><span class="co">#                           B: Placebo      C: Combination  </span></span>
<span><span class="co">#          F        M         (N=134)           (N=75)      </span></span>
<span><span class="co">#        (N=79)   (N=51)     F       M        F         M   </span></span>
<span><span class="co"># ——————————————————————————————————————————————————————————</span></span>
<span><span class="co"># Mean   32.76    35.57    34.12   37.44    35.20     35.38</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/int_methods.html">colcount_na_str</a></span><span class="op">(</span><span class="va">tbl3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"NaN"</span></span>
<span><span class="va">tbl3</span> <span class="co"># Shows NaN</span></span></code></pre></div>
<pre><code><span><span class="co">#           A: Drug X                                       </span></span>
<span><span class="co">#              NaN          B: Placebo      C: Combination  </span></span>
<span><span class="co">#          F        M         (N=134)           (N=75)      </span></span>
<span><span class="co">#        (N=79)   (N=51)     F       M        F         M   </span></span>
<span><span class="co"># ——————————————————————————————————————————————————————————</span></span>
<span><span class="co"># Mean   32.76    35.57    34.12   37.44    35.20     35.38</span></span></code></pre>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="nest">
  <p>rtables is a part of the <strong>NEST</strong> and <a href="https://pharmaverse.org/" class="external-link"><strong>pharmaverse</strong></a>.</p>
</div>
<script type="text/javascript" src="../analytics.js"></script></footer>
</div>





  </body>
</html>
