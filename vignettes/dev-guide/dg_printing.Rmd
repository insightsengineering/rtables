---
title: "Printing Machinery"
author: "Davide Garolini"
date: '`r Sys.Date()`'
output:
  html_document:
    theme: spacelab
    toc: true
    toc_float:
      collapsed: false
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Disclaimer

In comparison to other entries of the dev-guide, this is intended to keep track of the general concepts and processing pipeline behind the printing machinery. It is not intended to be a complete documentation of the machinery itself, but rather a collection of notes that can be used to understand the machinery and its internals. Hence, be aware that this is a working document that captures a snapshot of the machinery at a certain point in time. It is not meant to be fully maintained, but it can be used as a starting point for one.


### How `print` works

Lets track down what is going under the hood when a standard table is printed. The following is the code that is executed when a table is printed:

```{r}
library(rtables)
lyt <- basic_table() %>% 
  split_rows_by("SEX", split_fun = keep_split_levels(c("F", "M"))) %>% 
  split_cols_by("ARM") %>% 
  analyze("BMRKR1") %>% 
  print()
tbl <- build_table(lyt, ex_adsl) %>% 
  print()
```

We see that also a layout object (`PreDataTableLayouts`) is created and printed. This is because `print` is a generic function that dispatches to different methods depending on the class of the object. In this case, the S4 class of the object is `PreDataTableLayouts` and the method that is called is `print`. This method is defined in `00_print.R` and it is the following:

